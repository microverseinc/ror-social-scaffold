<p id="notice"><%= notice %></p>

<div class="columns my-1">
  <div class="column is-4 has-background-grey">
    <div class="my-5">
      <h5 class="has-text-centered my-3"><strong>Suggestions</strong></h5>
      <% User.all.each do |user|%>
        <% unless (current_user.friendships.exists?(user.friends)) %>
          <div class="box">
            <div class="columns">
              <div class="column is-6">
                <%= user.name.capitalize %>
              </div>
              <div class="column is-4">
                <%= form_for current_user.friendships.build(friend_id: user.id) do |f| %> 
                    <%= f.text_field :user_id, value: current_user.id, type: :hidden %>
                    <%= f.text_field :friend_id, value: user.id, type: :hidden %>
                    <%= f.text_field :confirmed, value: false, type: :hidden %>
                    <%= f.submit 'Add Friend', class:"button is-info px-5"%>
                <% end%>
              </div>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>

  <div class="column is-8 has-background-grey-lighter">
    <div class="my-5">
      <h5 class="has-text-centered my-3"><strong>Pending Friendships</strong></h5>
      <% @friendships.pending_friendship.each do |friendship| %>
        <%if (current_user.id == friendship.user_id) %>
          <div class="box">
            <div class="columns">
              <div class="column is-4">
                <%= friendship.friend.name.capitalize %>
              </div>
              <div class="column is-4">
              <button class="button is-grey">Request Sent</button>
              </div>
              <div class="column is-4">
              <%= link_to 'Delete request', friendship, method: :delete, data: { confirm: 'Are you sure?' }, class:"button is-danger" %>
              </div>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>

    <div class="my-5">
    <h5 class="has-text-centered my-3"><strong>Incoming Friendships</strong></h5>
      <% @friendships.pending_friendship.each do |friendship| %>
        <% unless (current_user.id == friendship.user_id) %>
          <div class="box">
            <div class="columns">
              <div class="column is-4">
                <%= friendship.friend.name.capitalize %>
              </div>
              <div class="column is-4">
                <%= form_for current_user.friendships.build(friend_id: friendship.friend_id) do |f| %> 
                  <%= f.text_field :user_id, value: current_user.id, type: :hidden %>
                  <%= f.text_field :friend_id, value: friendship.friend_id, type: :hidden %>
                  <%= f.text_field :confirmed, value: true, type: :hidden %>
                  <%= f.submit 'Confirm Friend', class:"button is-info px-5"%>
                <% end%>
              </div>
              <div class="column is-4">
                <%= link_to 'Delete request', friendship, method: :delete, data: { confirm: 'Are you sure?' }, class:"button is-danger" %>
              </div>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>

    <div class="my-5">
      <h5 class="has-text-centered my-3"><strong>Friends</strong></h5>
      <% @friendships.confirmed_friendship.each do |friendship| %>
        <div class="box">
          <div class="columns">
            <div class="column is-10">
              <%= friendship.friend.name.capitalize %>
            </div>
            <div class="column is-2">
              <%= link_to 'Unfriend', friendship, method: :delete, data: { confirm: 'Are you sure?' }, class:"button is-danger" %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
